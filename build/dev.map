{"version":3,"sources":["webpack:///webpack/bootstrap 76cad61e62436cffd78a","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///external \"path\"","webpack:///external \"request-ip\"","webpack:///external \"dotenv\"","webpack:///external \"babel-polyfill\"","webpack:///./server/index.js","webpack:///external \"consola\"","webpack:///external \"nuxt\"","webpack:///./server/router.js","webpack:///./server/event.router.js","webpack:///./server/visitor.router.js","webpack:///./server/db/controller/visitor.controller.js","webpack:///./server/db/model/visitor.schema.js","webpack:///external \"bluebird\"","webpack:///external \"ip2region\"","webpack:///external \"co\"","webpack:///./server/db/utils/index.js","webpack:///external \"fs\"","webpack:///external \"body-parser\"","webpack:///external \"cors\"","webpack:///external \"express-session\"","webpack:///external \"express-validator\"","webpack:///external \"connect-mongo\"","webpack:///./nuxt.config.js","webpack:///external \"webpackbar\"","webpack:///./server/config/index.js","webpack:///./server/config/env/development.js","webpack:///./server/config/env/production.js","webpack:///./server/db/model/event.schema.js","webpack:///./server/db/model ^\\.\\/.*$"],"names":["express","require","fs","join","path","bodyParser","mongoose","cors","requestIp","session","expressValidator","MongoStore","nuxtConfig","config","app","host","process","port","models","resolve","extended","module","console","file","fileName","basePath","router","nuxt","Nuxt","Builder","html","res","server","socketOptions","keepAlive","store","mongooseConnection","connection","logger","eventRouter","visitorRouter","controller","Visitor","IP2Region","async","wrap","only","exports","Object","req","query","ipAddress","visitor","result","data","Schema","VisitorSchema","type","default","trim","tag","platform","family","architecture","version","page","region","country","city","createTime","Date","now","userName","loadTimePeriod","startTime","opt","endTime","reqOption","grabAttribute","d","response","json","respondOrRedirect","url","obj","flash","keys","key","t","ret","WebpackBar","head","title","meta","charset","name","content","hid","link","rel","href","loading","color","css","env","baseURL","plugins","srcDir","build","vendor","extractCSS","isDev","isClient","enforce","test","loader","exclude","urlLoader","rule","limit","development","production","defaults","root","db","MONGODB","EventSchema","event","trime"],"mappings":"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","file":"dev.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 76cad61e62436cffd78a","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"request-ip\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request-ip\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"babel-polyfill\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = 6\n// module chunks = 0","const express = require('express')\nconst fs = require('fs')\nconst join = require('path').join\nconst path = require('path')\nimport { Nuxt, Builder } from 'nuxt'\nconst bodyParser = require('body-parser')\nconst mongoose = require('mongoose')\nconst cors = require('cors')\nconst requestIp = require('request-ip')\nconst session = require('express-session')\nconst expressValidator = require('express-validator')\nconst MongoStore = require('connect-mongo')(session)\nconst nuxtConfig = require('../nuxt.config.js')\nconst config = require('./config')\n\nrequire('dotenv').config()\nconst app = express()\nconst host = process.env.HOST || '0.0.0.0'\nconst port = process.env.PORT || 3005\nconst models = join(process.cwd(), '/server/db/model');\n\nconst resolve = file => path.resolve(__dirname, file)\n\napp.set('port', port)\napp.use('/dist', express.static(resolve('./dist')))\napp.use(bodyParser.json())\napp.use(bodyParser.urlencoded({\n  extended: true\n}))\napp.use(requestIp.mw())\napp.use(cors())\napp.use(expressValidator())\n\nmodule.exports = app\n\n/**\n * Router register\n */\n\nconsole.log(models)\nfs.readdirSync(models)\n  .filter(file => ~file.search(/^[^\\.].*\\.js$/))\n  .forEach(file => {\n    let fileName = file.slice(0, file.lastIndexOf('.'))\n    require('./db/model/' + fileName)\n  })\n\nconst basePath = '/api'\n\nimport router from './router.js'\napp.use(`${basePath}`, router)\n\nnuxtConfig.dev = !(process.env.NODE_ENV === 'production')\n\nconst nuxt = new Nuxt(nuxtConfig)\nif (nuxtConfig.dev) {\n  new Builder(nuxt).build()\n    .catch((error) => {\n      console.error(error)\n      process.exit(1)\n    })\n}\n\napp.use(nuxt.render)\n\napp.get('*', function (req, res) {\n  let html = fs.readFileSync(resolve('./' + 'index.html'), 'utf-8')\n  res.send(html)\n})\n\nmongoose.connect(config.db, {\n  server: {\n    socketOptions: {\n      keepAlive: 1\n    }\n  }\n})\n\napp.use(session({\n  store: new MongoStore({\n    mongooseConnection: mongoose.connection\n  })\n}))\n\napp.listen(port, host)\nlogger.success(`Server listening on http://localhost:${port}${basePath}`) // eslint-disable-line no-console\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","module.exports = require(\"consola\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"consola\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 9\n// module chunks = 0","import { Router } from 'express'\nimport eventRouter from './event.router'\nimport visitorRouter from './visitor.router'\n\nconst router = Router()\n\nrouter.use(eventRouter)\nrouter.use(visitorRouter)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/router.js","import { Router } from 'express'\nconst router = Router()\n\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/event.router.js","import { Router } from 'express'\nlet router = Router()\nconst controller = require('./db/controller/visitor.controller')\n\nrouter.post('/visitor/count', controller.create)\n\nrouter.post('/visitor/scan', controller.scan)\n\nrouter.get('/visitor/test', controller.test)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/visitor.router.js","/**\n * Module dependencies\n */\nconst mongoose = require('mongoose');\nconst Visitor = require('../model/visitor.schema.js')\n// const Visitor = mongoose.model('Visitor')\nmongoose.Promise = require('bluebird')\nconst IP2Region = require('ip2region')\nconst { wrap: async } = require('co');\nconst requestIp = require('request-ip')\nconst { only } = require('../utils/')\n\nexports.create = async(function* (req, res) {\n  const clientIp = requestIp.getClientIp(req)\n  const query = new IP2Region()\n  let d = Object.assign(req.body, only(query.search(clientIp), 'region country city'))\n  let visitorData = Object.assign(d, { ipAddress: clientIp })\n  console.log(visitorData)\n  const visitor = new Visitor(visitorData)\n  try {\n    yield visitor.save()\n    res.status(200).json({\n      result: 'success'\n    })\n  } catch (err) {\n    console.log(err)\n    res.status(422)\n  }\n})\n\n/**\n * Load the visitor data with some limitations\n */\nexports.scan = async (function* (req, res) {\n  const filters = req.body\n  console.log(filters)\n  try {\n    let data = yield Visitor.loadTimePeriod(filters)\n    console.log(data)\n  } catch (err) {\n    console.error(err)\n    res.status(422)\n  }\n})\n\nexports.test = function (req, res) {\n  console.log('aaa')\n  res.status(200).json({\n    data: 1\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/db/controller/visitor.controller.js","const mongoose = require('mongoose')\n\nconst Schema = mongoose.Schema\n\nconst VisitorSchema = new Schema({\n  ipAddress: {\n    type: String,\n    default: 'not found',\n    trim: true\n  },\n  tag: {\n    type: String,\n    default: '',\n    trim: true\n  },\n  platform: {\n    type: String,\n    default: '',\n    trim: true,\n  },\n  family: {\n    type: String,\n    default: '',\n    trim: true,\n  },\n  architecture: {\n    type: String,\n    default: '',\n    trim: true,\n  },\n  version: {\n    type: String,\n    default: '',\n    trim: true\n  },\n  page: {\n    type: String,\n    default: '',\n    trim: true\n  },\n  region: {\n    type: String,\n    default: '',\n    trim: true\n  },\n  country: {\n    type: String,\n    default: '',\n    trim: true\n  },\n  city: {\n    type: String,\n    default: '',\n    trim: true\n  },\n  createTime: {\n    type: Date,\n    default: Date.now\n  },\n  userName: {\n    type: String,\n    default: '',\n    trim: true\n  }\n})\n\n/**\n * basic validation\n */\nVisitorSchema.path('ipAddress').required(true, 'ip address can not be blank')\nVisitorSchema.path('tag').required(true, 'tag can not be blank')\nVisitorSchema.path('page').required(true, 'page can not be blank')\n\n\n/**\n * Methods \n * bind on the instance\n */\nVisitorSchema.methods = {\n\n}\n\n/**\n * Statics\n */\nVisitorSchema.statics = {\n  loadTimePeriod: (opt) => {\n    const startTime = new Date(opt['startTime']) || new Date('2000-01-01')\n    const endTime = new Date(opt['endTime']) || new Date()\n    const reqOption = {\n      createTime: {\n        '$gte': startTime.toISOString(),\n        '$lte': endTime.toISOString()\n      }\n    }\n    return this.find(reqOption)\n  }\n}\n\nmongoose.model('Visitor', VisitorSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/db/model/visitor.schema.js","module.exports = require(\"bluebird\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bluebird\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"ip2region\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ip2region\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"co\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"co\"\n// module id = 17\n// module chunks = 0","/**\n * Utils\n */\nconst grabAttribute = (chain, target) => {\n  return chain.split('.').reduce((d, i) => {\n      return typeof d == 'undefined' ? d : d[i]\n  }, target)\n}\n\nconst response = (res, tpl, obj, status) => {\n  res.format({\n    html: () => res.render(tpl, obj),\n    json: () => {\n      if (status) return res.status(status).json(obj);\n      res.json(obj);\n    }\n  });\n}\n\nconst respondOrRedirect = ({ req, res }, url = '/', obj = {}, flash) => {\n  res.format({\n    html: () => {\n      if (req && flash) req.flash(flash.type, flash.text);\n      res.redirect(url);\n    },\n    json: () => res.json(obj)\n  });\n}\n\nconst only = (obj, keys) => {\n  obj = obj || {};\n  if ('string' === typeof keys) keys = keys.split(/ +/);\n  return keys.reduce((ret, key) => {\n      if (null === obj[key]) return ret\n      if (key.indexOf('.') !== -1) {\n          let t = key.slice(key.lastIndexOf('.') + 1)\n          ret[t] = grabAttribute(key, obj)\n      } else {\n          ret[key] = obj[key]\n      }\n      return ret\n  }, {})\n}\n\n\nmodule.exports = {\n  response,\n  respondOrRedirect,\n  only\n}\n\n\n// WEBPACK FOOTER //\n// ./server/db/utils/index.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cors\"\n// module id = 21\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 22\n// module chunks = 0","module.exports = require(\"express-validator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-validator\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"connect-mongo\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-mongo\"\n// module id = 24\n// module chunks = 0","const WebpackBar = require('webpackbar')\nrequire('dotenv').config()\nconst path = process.env.NUXT_ENV || ''\n\nmodule.exports = {\n    /*\n    ** Headers of the page\n    */\n    head: {\n      title: 'nuxt',\n      meta: [\n        { charset: 'utf-8' },\n        { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n        { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n      ],\n      link: [\n        { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' },\n        { rel: 'stylesheet', href: 'https://unpkg.com/element-ui/lib/theme-chalk/index.css' },\n      ]\n    },\n    /*\n    ** Customize the progress bar color\n    */\n    loading: { color: '#3B8070' },\n    /**\n     * Gobal CSS import\n     */\n    css: [\n      '~/assets/css/global.css'\n    ],\n    env: {\n      basePath: `${path}`,\n      baseURL: (process.env.BASE_URL || 'http://localhost:3005') + `/${path}`\n    },\n    /**\n     * plugins\n     */\n    plugins: [\n        '~/plugins/element-ui',\n        '~/plugins/svg-icon',\n    ],\n    srcDir: 'src-nuxt/',\n    /*\n    ** Build configuration\n    */\n    build: {\n      vendor: ['babel-polyfill', 'axios', '~/plugins/element-ui.js'],\n      extractCSS: true,\n      /*\n      ** Run ESLint on save\n      */\n      extend (config, { isDev, isClient }) {\n        if (isDev && isClient) {\n          config.module.rules.push({\n            enforce: 'pre',\n            test: /\\.(js|vue)$/,\n            loader: 'eslint-loader',\n            exclude: /(node_modules)/\n          })\n        }\n        const urlLoader = config.module.rules.find((rule) => rule.loader === 'url-loader')\n        config.module.rules.splice(config.module.rules.indexOf(urlLoader), 1)\n        config.module.rules.push({\n          test: /\\.(png|jpe?g|gif|svg)$/,\n          loader: 'url-loader',\n          exclude: /(assets\\/svg)/,\n          query: {\n            limit: 500 * 1000, // 500KO\n            name: 'img/[name].[hash:7].[ext]'\n          }\n        })\n\n        config.plugins.push(new WebpackBar())\n      }\n    }\n  }\n  \n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","module.exports = require(\"webpackbar\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpackbar\"\n// module id = 26\n// module chunks = 0","const path = require('path')\n\nconst development = require('./env/development')\nconst production = require('./env/production')\n\nconst defaults = {\n  root: path.join(__dirname, '..')\n}\n\nmodule.exports = {\n  development: Object.assign({}, development, defaults),\n  production: Object.assign({}, production, defaults)\n}[process.env.NODE_ENV || 'development']\n\n\n// WEBPACK FOOTER //\n// ./server/config/index.js","/**\n * Expose\n */\nmodule.exports = {\n  db: 'mongodb://localhost/logger'\n}\n\n\n// WEBPACK FOOTER //\n// ./server/config/env/development.js","/**\n * Expose\n */\nmodule.exports = {\n  db: process.env.MONGODB\n}\n\n\n// WEBPACK FOOTER //\n// ./server/config/env/production.js","const mongoose = require('mongoose')\n\nconst Schema = mongoose.Schema\n\nconst EventSchema = new Schema({\n    ipAddress: {\n        type: String,\n        default: 'not found',\n        trim: true\n      },\n      event: {\n        type: String,\n        default: '',\n        trime: true\n      },\n      tag: {\n        type: String,\n        default: '',\n        trim: true\n      },\n      platform: {\n        type: String,\n        default: '',\n        trim: true,\n      },\n      family: {\n        type: String,\n        default: '',\n        trim: true,\n      },\n      architecture: {\n        type: String,\n        default: '',\n        trim: true,\n      },\n      version: {\n        type: String,\n        default: '',\n        trim: true\n      },\n      page: {\n        type: String,\n        default: '',\n        trim: true\n      },\n      region: {\n        type: String,\n        default: '',\n        trim: true\n      },\n      country: {\n        type: String,\n        default: '',\n        trim: true\n      },\n      city: {\n        type: String,\n        default: '',\n        trim: true\n      },\n      createTime: {\n        type: Date,\n        default: Date.now\n      },\n      userName: {\n        type: String,\n        default: '',\n        trim: true\n      } \n})\n\n/**\n * basic validation\n */\nEventSchema.path('ipAddress').required(true, 'ip address can not be blank')\nEventSchema.path('tag').required(true, 'tag can not be blank')\nEventSchema.path('page').required(true, 'page can not be blank')\n\n\n/**\n * Methods \n * bind on the instance\n */\nEventSchema.methods = {\n\n}\n\n/**\n * Statics\n */\nEventSchema.statics = {\n  loadTimePeriod: (opt) => {\n    const startTime = new Date(opt['startTime']) || new Date('2000-01-01')\n    const endTime = new Date(opt['endTime']) || new Date()\n    const reqOption = {\n      createTime: {\n        '$gte': startTime.toISOString(),\n        '$lte': endTime.toISOString()\n      }\n    }\n    return this.find(reqOption)\n  }\n}\n\nmongoose.model('Event', EventSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./server/db/model/event.schema.js","var map = {\n\t\"./event.schema\": 31,\n\t\"./event.schema.js\": 31,\n\t\"./visitor.schema\": 14,\n\t\"./visitor.schema.js\": 14\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 32;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/db/model ^\\.\\/.*$\n// module id = 32\n// module chunks = 0"],"sourceRoot":""}